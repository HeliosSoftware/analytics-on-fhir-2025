{
  "name": "Tpd",
  "remarks": [
    "Tests Pending at Discharge - generates lab observations with realistic post-discharge timing",
    "Distribution matches real-world data: Cultures vs Other labs with time-based patterns"
  ],
  "states": {
    "Initial": {
      "type": "Initial",
      "direct_transition": "Age_Guard"
    },
    "Age_Guard": {
      "type": "Guard",
      "allow": {
        "condition_type": "Age",
        "operator": "<",
        "quantity": 140,
        "unit": "years"
      },
      "direct_transition": "Hospital_Visit"
    },
    "Hospital_Visit": {
      "type": "Encounter",
      "encounter_class": "inpatient",
      "reason": "",
      "telemedicine_possibility": "none",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 32485007,
          "display": "Hospital admission"
        }
      ],
      "direct_transition": "Lab_Count_Decision"
    },
    "Lab_Count_Decision": {
      "type": "Simple",
      "remarks": ["Decide how many labs this encounter will generate (0-5)"],
      "distributed_transition": [
        {"transition": "No_Labs", "distribution": 0.05},
        {"transition": "Set_Lab_Count_1", "distribution": 0.20},
        {"transition": "Set_Lab_Count_2", "distribution": 0.30},
        {"transition": "Set_Lab_Count_3", "distribution": 0.25},
        {"transition": "Set_Lab_Count_4", "distribution": 0.15},
        {"transition": "Set_Lab_Count_5", "distribution": 0.05}
      ]
    },
    "No_Labs": {
      "type": "Simple",
      "direct_transition": "Hospital_Visit_End"
    },
    "Set_Lab_Count_1": {
      "type": "SetAttribute",
      "attribute": "labs_remaining",
      "value": 1,
      "direct_transition": "Time_Bucket_Selection"
    },
    "Set_Lab_Count_2": {
      "type": "SetAttribute",
      "attribute": "labs_remaining",
      "value": 2,
      "direct_transition": "Time_Bucket_Selection"
    },
    "Set_Lab_Count_3": {
      "type": "SetAttribute",
      "attribute": "labs_remaining",
      "value": 3,
      "direct_transition": "Time_Bucket_Selection"
    },
    "Set_Lab_Count_4": {
      "type": "SetAttribute",
      "attribute": "labs_remaining",
      "value": 4,
      "direct_transition": "Time_Bucket_Selection"
    },
    "Set_Lab_Count_5": {
      "type": "SetAttribute",
      "attribute": "labs_remaining",
      "value": 5,
      "direct_transition": "Time_Bucket_Selection"
    },
    "Time_Bucket_Selection": {
      "type": "Simple",
      "remarks": ["Select INCREMENTAL delay - values compound across loop iterations. Tuned for target distribution."],
      "distributed_transition": [
        {"transition": "Bucket_0_1_Days", "distribution": 0.48},
        {"transition": "Bucket_1_2_Days", "distribution": 0.24},
        {"transition": "Bucket_2_3_Days", "distribution": 0.08},
        {"transition": "Bucket_3_4_Days", "distribution": 0.05},
        {"transition": "Bucket_4_6_Days", "distribution": 0.03},
        {"transition": "Bucket_6_10_Days", "distribution": 0.03},
        {"transition": "Bucket_10_Plus_Days", "distribution": 0.09}
      ]
    },
    "Bucket_0_1_Days": {
      "type": "Delay",
      "distribution": {
        "kind": "UNIFORM",
        "parameters": {"low": 0.01, "high": 0.99}
      },
      "unit": "days",
      "remarks": ["0-1 days: 48.5% Culture, 51.5% Other"],
      "distributed_transition": [
        {"transition": "Culture_Lab_Selection", "distribution": 0.4853},
        {"transition": "Other_Lab_Selection", "distribution": 0.5147}
      ]
    },
    "Bucket_1_2_Days": {
      "type": "Delay",
      "distribution": {
        "kind": "UNIFORM",
        "parameters": {"low": 1.01, "high": 1.99}
      },
      "unit": "days",
      "remarks": ["1-2 days: 64.4% Culture, 35.6% Other"],
      "distributed_transition": [
        {"transition": "Culture_Lab_Selection", "distribution": 0.6442},
        {"transition": "Other_Lab_Selection", "distribution": 0.3558}
      ]
    },
    "Bucket_2_3_Days": {
      "type": "Delay",
      "distribution": {
        "kind": "UNIFORM",
        "parameters": {"low": 2.01, "high": 2.99}
      },
      "unit": "days",
      "remarks": ["2-3 days: 57.5% Culture, 42.5% Other"],
      "distributed_transition": [
        {"transition": "Culture_Lab_Selection", "distribution": 0.5747},
        {"transition": "Other_Lab_Selection", "distribution": 0.4253}
      ]
    },
    "Bucket_3_4_Days": {
      "type": "Delay",
      "distribution": {
        "kind": "UNIFORM",
        "parameters": {"low": 3.01, "high": 3.99}
      },
      "unit": "days",
      "remarks": ["3-4 days: 57.4% Culture, 42.6% Other"],
      "distributed_transition": [
        {"transition": "Culture_Lab_Selection", "distribution": 0.5736},
        {"transition": "Other_Lab_Selection", "distribution": 0.4264}
      ]
    },
    "Bucket_4_6_Days": {
      "type": "Delay",
      "distribution": {
        "kind": "UNIFORM",
        "parameters": {"low": 4.01, "high": 5.99}
      },
      "unit": "days",
      "remarks": ["4-6 days: 37.6% Culture, 62.4% Other"],
      "distributed_transition": [
        {"transition": "Culture_Lab_Selection", "distribution": 0.3757},
        {"transition": "Other_Lab_Selection", "distribution": 0.6243}
      ]
    },
    "Bucket_6_10_Days": {
      "type": "Delay",
      "distribution": {
        "kind": "UNIFORM",
        "parameters": {"low": 6.01, "high": 9.99}
      },
      "unit": "days",
      "remarks": ["6-10 days: 24.1% Culture, 75.9% Other - LOWEST volume bucket"],
      "distributed_transition": [
        {"transition": "Culture_Lab_Selection", "distribution": 0.2414},
        {"transition": "Other_Lab_Selection", "distribution": 0.7586}
      ]
    },
    "Bucket_10_Plus_Days": {
      "type": "Delay",
      "distribution": {
        "kind": "UNIFORM",
        "parameters": {"low": 10.01, "high": 16}
      },
      "unit": "days",
      "remarks": ["10+ days: 78.2% Culture, 21.8% Other - heavily culture-weighted"],
      "distributed_transition": [
        {"transition": "Culture_Lab_Selection", "distribution": 0.92},
        {"transition": "Other_Lab_Selection", "distribution": 0.08}
      ]
    },
    "Culture_Lab_Selection": {
      "type": "Simple",
      "remarks": ["Select which culture lab to generate"],
      "distributed_transition": [
        {"transition": "Blood_Culture_Obs", "distribution": 0.40},
        {"transition": "Urine_Culture_Obs", "distribution": 0.35},
        {"transition": "Wound_Culture_Obs", "distribution": 0.15},
        {"transition": "Sputum_Culture_Obs", "distribution": 0.10}
      ]
    },
    "Other_Lab_Selection": {
      "type": "Simple",
      "remarks": ["Select which non-culture lab to generate"],
      "distributed_transition": [
        {"transition": "Sodium_Obs", "distribution": 0.20},
        {"transition": "Potassium_Obs", "distribution": 0.20},
        {"transition": "Chloride_Obs", "distribution": 0.15},
        {"transition": "Creatinine_Obs", "distribution": 0.15},
        {"transition": "Cholesterol_Obs", "distribution": 0.10},
        {"transition": "HDL_Obs", "distribution": 0.10},
        {"transition": "Triglyceride_Obs", "distribution": 0.10}
      ]
    },
    "Blood_Culture_Obs": {
      "type": "Observation",
      "category": "laboratory",
      "unit": "",
      "codes": [
        {
          "system": "LOINC",
          "code": "600-7",
          "display": "Bacteria identified in Blood by Culture"
        }
      ],
      "value_code": {
        "system": "SNOMED-CT",
        "code": "264868006",
        "display": "No growth"
      },
      "direct_transition": "Lab_Counter_Decrement"
    },
    "Urine_Culture_Obs": {
      "type": "Observation",
      "category": "laboratory",
      "unit": "",
      "codes": [
        {
          "system": "LOINC",
          "code": "630-4",
          "display": "Bacteria identified in Urine by Culture"
        }
      ],
      "value_code": {
        "system": "SNOMED-CT",
        "code": "264868006",
        "display": "No growth"
      },
      "direct_transition": "Lab_Counter_Decrement"
    },
    "Wound_Culture_Obs": {
      "type": "Observation",
      "category": "laboratory",
      "unit": "",
      "codes": [
        {
          "system": "LOINC",
          "code": "43409-2",
          "display": "Bacteria identified in Wound by Culture"
        }
      ],
      "value_code": {
        "system": "SNOMED-CT",
        "code": "264868006",
        "display": "No growth"
      },
      "direct_transition": "Lab_Counter_Decrement"
    },
    "Sputum_Culture_Obs": {
      "type": "Observation",
      "category": "laboratory",
      "unit": "",
      "codes": [
        {
          "system": "LOINC",
          "code": "6463-4",
          "display": "Bacteria identified in Sputum by Culture"
        }
      ],
      "value_code": {
        "system": "SNOMED-CT",
        "code": "264868006",
        "display": "No growth"
      },
      "direct_transition": "Lab_Counter_Decrement"
    },
    "Sodium_Obs": {
      "type": "Observation",
      "category": "laboratory",
      "unit": "mmol/L",
      "codes": [
        {
          "system": "LOINC",
          "code": "2951-2",
          "display": "Sodium [Moles/volume] in Serum or Plasma"
        }
      ],
      "distribution": {
        "kind": "GAUSSIAN",
        "parameters": {"mean": 140, "standardDeviation": 3}
      },
      "direct_transition": "Lab_Counter_Decrement"
    },
    "Potassium_Obs": {
      "type": "Observation",
      "category": "laboratory",
      "unit": "mmol/L",
      "codes": [
        {
          "system": "LOINC",
          "code": "2823-3",
          "display": "Potassium [Moles/volume] in Serum or Plasma"
        }
      ],
      "distribution": {
        "kind": "GAUSSIAN",
        "parameters": {"mean": 4.5, "standardDeviation": 0.5}
      },
      "direct_transition": "Lab_Counter_Decrement"
    },
    "Chloride_Obs": {
      "type": "Observation",
      "category": "laboratory",
      "unit": "mmol/L",
      "codes": [
        {
          "system": "LOINC",
          "code": "2075-0",
          "display": "Chloride [Moles/volume] in Serum or Plasma"
        }
      ],
      "distribution": {
        "kind": "GAUSSIAN",
        "parameters": {"mean": 101, "standardDeviation": 3}
      },
      "direct_transition": "Lab_Counter_Decrement"
    },
    "Creatinine_Obs": {
      "type": "Observation",
      "category": "laboratory",
      "unit": "mg/dL",
      "codes": [
        {
          "system": "LOINC",
          "code": "2160-0",
          "display": "Creatinine [Mass/volume] in Serum or Plasma"
        }
      ],
      "distribution": {
        "kind": "GAUSSIAN",
        "parameters": {"mean": 1.0, "standardDeviation": 0.2}
      },
      "direct_transition": "Lab_Counter_Decrement"
    },
    "Cholesterol_Obs": {
      "type": "Observation",
      "category": "laboratory",
      "unit": "mg/dL",
      "codes": [
        {
          "system": "LOINC",
          "code": "2093-3",
          "display": "Cholesterol [Mass/volume] in Serum or Plasma"
        }
      ],
      "distribution": {
        "kind": "GAUSSIAN",
        "parameters": {"mean": 200, "standardDeviation": 30}
      },
      "direct_transition": "Lab_Counter_Decrement"
    },
    "HDL_Obs": {
      "type": "Observation",
      "category": "laboratory",
      "unit": "mg/dL",
      "codes": [
        {
          "system": "LOINC",
          "code": "2085-9",
          "display": "Cholesterol in HDL [Mass/volume] in Serum or Plasma"
        }
      ],
      "distribution": {
        "kind": "GAUSSIAN",
        "parameters": {"mean": 55, "standardDeviation": 15}
      },
      "direct_transition": "Lab_Counter_Decrement"
    },
    "Triglyceride_Obs": {
      "type": "Observation",
      "category": "laboratory",
      "unit": "mg/dL",
      "codes": [
        {
          "system": "LOINC",
          "code": "2571-8",
          "display": "Triglyceride [Mass/volume] in Serum or Plasma"
        }
      ],
      "distribution": {
        "kind": "GAUSSIAN",
        "parameters": {"mean": 150, "standardDeviation": 50}
      },
      "direct_transition": "Lab_Counter_Decrement"
    },
    "Lab_Counter_Decrement": {
      "type": "Counter",
      "attribute": "labs_remaining",
      "action": "decrement",
      "conditional_transition": [
        {
          "condition": {
            "condition_type": "Attribute",
            "attribute": "labs_remaining",
            "operator": ">",
            "value": 0
          },
          "transition": "Time_Bucket_Selection"
        },
        {
          "transition": "Hospital_Visit_End"
        }
      ]
    },
    "Hospital_Visit_End": {
      "type": "EncounterEnd",
      "direct_transition": "Terminal"
    },
    "Terminal": {
      "type": "Terminal"
    }
  },
  "gmf_version": 2
}
